{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/phoenix-liveview-and-views/","result":{"data":{"site":{"siteMetadata":{"title":"David Bernheisel","author":"David Bernheisel"}},"markdownRemark":{"id":"34e3b89d-d205-58e2-8bd8-925ee94b5d22","excerpt":"I’ve written a couple LiveView applications now, Elixir Regex Tester A request logger, much like Phoenix Live Dashboard’s An internal…","timeToRead":13,"html":"<p>I’ve written a couple LiveView applications now,</p>\n<ol>\n<li><a href=\"https://elixir-utilities.herokuapp.com\">Elixir Regex Tester</a></li>\n<li>A request logger, much like <a href=\"https://github.com/phoenixframework/phoenix_live_dashboard\">Phoenix Live Dashboard</a>’s</li>\n<li>An internal webmail server, for me to receive and send email through\nSendGrid. I hope to open-source this soon when it’s ready.</li>\n<li>Another private work-related project.</li>\n</ol>\n<p>Everytime I build one, I learn something new and find a new pattern, and some\nconcept finally <em>clicks</em>. Today, that concept that cemented in my mind is how\nPhoenix and Phoenix LiveView renders templates.</p>\n<p>I want to show you a couple different View-rendering strategies. This should\nhelp you decide which strategy to use.</p>\n<p>All of these strategies work, this is purely about opinionated code organizing,\n<em>but who doesn’t love reading opinions</em>? Plus we’ll learn how the views are\nrendered.</p>\n<p>This is written while using Phoenix LiveView 0.13.3.</p>\n<h2>TL;DR</h2>\n<p>Glossary of examples:</p>\n<ol>\n<li><code>MyLive</code> = The LiveView module</li>\n<li><code>MyView</code> = The standard Phoenix View module, not a LiveView.</li>\n<li><code>my_live.html.leex</code> = The template rendered by <code>MyLive</code> or <code>MyView</code></li>\n</ol>\n<p><strong>If you have a simple LiveView</strong>, then you can implement <code>render(assigns)</code>\nand inline your html with the <code>~L</code> sigil. No <code>my_live.html.leex</code> file needed.</p>\n<p><strong>If you have a LiveView with lots of HTML</strong>, then you should use the standard\nLiveView placement, and put your <code>my_live.ex</code> and <code>my_live.html.leex</code> next to\neach other under <code>lib/my_app_web/live</code>. You don’t need to define <code>render/1</code>\nbecause the default will work. Omit it.</p>\n<p><strong>If you have a LiveView with lots of HTML helper functions</strong> that you want to\nseparate from business logic in the LiveView:</p>\n<ol>\n<li>Add your own standard Phoenix view <code>MyView</code> (or a better name).</li>\n<li>Move your <code>my_live.html.leex</code> file to the standard Phoenix locations (ie,\n<code>lib/my_app_web/templates/my</code>).</li>\n<li>Implement your own <code>render(assigns)</code> that calls\n<code>MyAppWeb.MyView.render(\"my_live.html\", assigns)</code>. Phoenix LiveView will\nstill work; just remember to keep the html file named with an <code>.html.leex</code>\nextension so the LiveView rendering engine kicks in.</li>\n</ol>\n<p><strong>Remember that you can create shared Views</strong>. Alternatively, if your\nhelpers are used across multiple views and are generic, you can create a plain\nmodule that encapsulates your HTML helpers. I usually call mine <code>ComponentView</code>\nand use it inside any of my templates, for example:\n<code>Component.primary_button(\"My Link\", to: \"yadayada\")</code>.</p>\n<p><strong>If you want to use a regular View, but co-locate the template to the LiveView module</strong>,\nas in you don’t want to go back to the vanilla Phoenix file structure but still\nneed a separate <code>MyView</code> for your HTML helpers, you can specify the root\nfolder and path to look in when creating your <code>MyView</code> by supplying an option:\n<code>use Phoenix.View, root: \"lib/my_app_web/live\", path: \"\"</code>. This is <a href=\"https://hexdocs.pm/phoenix/Phoenix.View.html#__using__/1-options\">explained in the\n<code>Phoenix.View</code>\ndocs</a>. This\ncan be wrapped up into a convenience macro though. Read on for more info.</p>\n<p><strong>This totally ignores LiveComponent</strong> as an option. If your LiveView can be\nbroken up into interactive components, then breaking out into a LiveComponent is\na good option to look into and works just like a LiveView. For the purpose of\nthis post and exploring how rendering works, we’re going to treat LiveComponents\nthe same as a LiveView.</p>\n<h2>ToC</h2>\n<ul>\n<li><a href=\"#default-phoenix\">Phoenix Controller/View/Template</a></li>\n<li><a href=\"#default-liveview\">Phoenix LiveView with a template Part 1</a></li>\n<li><a href=\"#pluggy-controllers\">Pluggy Controllers</a></li>\n<li><a href=\"#default-liveview\">Phoenix LiveView with a template Part 2</a></li>\n<li><a href=\"#liveview-inline\">Phoenix LiveView with an inline template</a></li>\n<li><a href=\"#liveview-external\">Phoenix LiveView with an external template</a></li>\n</ul>\n<p><a name=\"default-phoenix\"></a></p>\n<h2>Default Phoenix Controller/View/Template</h2>\n<p>First, to remember where we came from, I want to show a standard Phoenix\nController/View/Template pattern. There are several modules involved that the\n<code>Plug.Conn</code> travels through in order to turn into a response for the end-user.</p>\n<ol>\n<li>Incoming request via <code>:cowboy</code></li>\n<li>Endpoint</li>\n<li>Router</li>\n<li>Controller</li>\n<li>View</li>\n<li>Template (not a module)</li>\n<li>Outgoing response via <code>:cowboy</code></li>\n</ol>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Router - lib/my_app_web/router.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.Router</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:router</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ...snip...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  scope </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;/&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    pipe_through </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:browser</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    get </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;/&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">PageController</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:home</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ...snip...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Controller - lib/my_app_web/controllers/page_controller.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.PageController</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#&lt;-- injects some logic to handle receiving</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># the conn and passing the conn on to cowboy</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">home</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_params</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    render(conn, </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;home.html&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### View - lib/my_app_web/views/page_view.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.PageView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:view</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#&lt;-- injects some logic to handle evaluating</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># the embedded elixir in your templates</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"html\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">&lt;!-- Template - lib/my_app_web/templates/page/home.html.eex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">We&#39;re going to ignore the layout stuff for now. Just know that it&#39;s</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">also evaluated and this template is a part of it --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;Yo! You&#39;re rendering the home page&lt;/</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;</span></span></span></code></pre>\n<p>In my mind, the template is the end of the show, though that’s not technically\ncorrect; the real <strong>end of the line is the controller</strong>. The controller is using\nthe view module to evaluate the HTML and puts the result into the Plug.Conn’s\n<code>resp_body</code>. The controller terminates the flow and the\nonce-a-request-and-now-a-response <code>Plug.Conn</code> is returned to the to the\nunderlying web server, which delivers the payload to the end-user through the\nHTTP connection.</p>\n<p><a name=\"default-liveview\"></a></p>\n<h2>Default Phoenix LiveView without <code>render/1</code></h2>\n<p>We’re here to learn about LiveView though, so let’s see an example of a LiveView\nwithout a <code>render/1</code> function.</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/live/my_live.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyLive</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:live_view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@impl</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">mount</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_params</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_session</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">socket</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># do stuff</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    {</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:ok</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, socket}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"html\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">&lt;!-- lib/my_app_web/live/my_live.html.leex --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;Yo! I&#39;m rendered by a LiveView&lt;/</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;</span></span></span></code></pre>\n<p>Ok, without a controller, how does a given Phoenix LiveView handle the request?\nHere’s a secret: <strong>a LiveView is also an ordinary controller</strong>.</p>\n<p>Now… we may not use it like an ordinary Phoenix controller, but the request is\nfirstly handled like an ordinary web request; one with a Plug.Conn and a full\nHTML response back to the user. The LiveView spices are garnished <em>after</em> the\nHTML is delivered to the user and a new websocket is initiated to the server to\nthe page updates to the page.</p>\n<p>As said in the LiveView docs:</p>\n<blockquote>\n<p>A LiveView begins as a regular HTTP request and HTML response,\nand then upgrades to a stateful view on client connect,\nguaranteeing a regular HTML page even if JavaScript is disabled.\nAny time a stateful view changes or updates its socket assigns, it is\nautomatically re-rendered and the updates are pushed to the client.</p>\n</blockquote>\n<blockquote>\n<p>Prove it!</p>\n<p> — you</p>\n</blockquote>\n<p>ok ok.. I’ll prove it. To prove that it’s a regular controller, we’ll need to\nlook at some of Phoenix LiveView’s source code. Let’s look at the code that\nmakes <code>live(\"/my-route\", MyLive)</code> work in the router.</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmacro</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">live</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">path</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">live_view</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">action</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">\\\\</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">nil</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">opts</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">\\\\</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> []) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">bind_quoted:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> binding() </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    {action, router_options} </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Router</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.__live__(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, live_view, action, opts)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># vvvvv THIS PART</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Router</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.get(path, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Plug</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, action, router_options)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ^^^^^ THIS PART</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<p>You see it?! <code>live()</code> is calling this function:</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Router</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.get(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;/my-route&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Plug</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_action</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_options</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span></code></pre>\n<p>You may recognize this as:</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">get </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;/my-route&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyController</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:show</span></span></span></code></pre>\n<p>in your own router. We’re going to ignore the action and options for this post,\nbut the important part is that the <code>live()</code> macro is adding a GET route and\ncalls the <code>Phoenix.LiveView.Plug</code></p>\n<blockquote>\n<p>But, that plug isn’t a controller…</p>\n<p>— you</p>\n</blockquote>\n<p>Ah, but it is! A Phoenix Controller, even the ones you make, are indeed all just\nplugs underneath. <a href=\"https://hexdocs.pm/phoenix/plug.html\"><strong>All Phoenix controllers are\nplugs</strong></a>.</p>\n<p><a name=\"pluggy-controllers\"></a></p>\n<h2>Pluggy Controllers</h2>\n<p>When your controllers call <code>use MyAppWeb, :controller</code>, it’s <em>injecting code</em>\ninto your controller at compile-time. Let’s explore how that works.</p>\n<p>First at step 0 we need to understand that when Elixir code calls <code>use MyUsingModule</code> it’s actually calling <code>MyUsingModule.__using__(opts)</code> at\ncompile-time, and that resulting code is put into the module that called it.\nKnowing that, let’s follow the <code>use</code> trail.</p>\n<p>Starting at the top in our own code:</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">######################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Inside MyAppWeb.PageController ###</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">######################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.PageController</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:controller</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">home</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    render(conn, </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;home.html&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#######################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Inside MyAppWeb ###</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#######################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmacro</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">__using__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">which</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">when</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> is_atom(which) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  apply(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, which, [])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># vvv let&#39;s look in here vvv</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">namespace:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ^^^ let&#39;s look in here ^^^</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Inside Phoenix.Controller ###</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmacro</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">__using__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">opts</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">bind_quoted:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> [</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">opts:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> opts] </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># vvv let&#39;s look in here vvv</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Pipeline</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, opts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ^^^ let&#39;s look in here ^^^</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">if</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Keyword</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.get(opts, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:put_default_views</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">true</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      plug </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:put_new_layout</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, {</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.__layout__(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, opts), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:app</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      plug </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:put_new_view</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.__view__(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">##########################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### Inside Phoenix.Controller.Pipeline ###</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">##########################################</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmacro</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">__using__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">opts</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">bind_quoted:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> [</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">opts:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> opts] </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@behaviour</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Plug</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">## AHA! HERE&#39;S YOUR CONTROLLER PLUG BEHAVIOUR</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">require</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Endpoint</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Pipeline</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Module</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.register_attribute(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:plugs</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">accumulate:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">true</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@before_compile</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Pipeline</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@phoenix_log_level</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Keyword</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.get(opts, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:log</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:debug</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@phoenix_fallback</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:unregistered</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">@doc false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">init</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">opts</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">do:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> opts</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">@doc false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">call</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">action</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">when</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> is_atom(action) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      conn</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> merge_private(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">        </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">phoenix_controller:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">        </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">phoenix_action:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> action</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># fun fact, this function below was introduced</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ~6 years ago in Phoenix 0.5.0 and utilizes unhygienic functions.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># (as in you&#39;re in deep macro-land and your normal rules don&#39;t apply)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> phoenix_controller_pipeline(action)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">@doc false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">action</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(%</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Plug</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">{</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">private:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> %{</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">phoenix_action:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">action</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">}} </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_options</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      apply(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-12\">__MODULE__</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, action, [conn, conn.params])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defoverridable</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">init:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">1</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">call:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">2</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">action:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<p>Wow! Wild. All this means our slim controllers actually have a lot more code in\nit than it appears, and that’s ok because it makes working in Phoenix much more\nconvenient.</p>\n<p><a href=\"https://hexdocs.pm/plug/Plug.html\">All plugs must implement <code>call/2</code> which accepts a conn and returns a\nconn</a>. In our case, we’re looking for a conn\nthat has some rendered HTML.</p>\n<p><a name=\"liveview-default-2\"></a></p>\n<h2>Back to Default Phoenix LiveView without <code>render/1</code></h2>\n<p>Now that we know that LiveViews are a <code>GET</code> request using a standard\ncontroller/plug underneath, let’s look at the <code>Phoenix.LiveView.Plug</code>. We’re\nstill looking for how a LiveView gets to the template.</p>\n<p>LiveView has a similar <code>__using__</code> code-path. Let’s look at LiveView’s plug:</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">call</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(%{</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">private:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> %{</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">phoenix_live_view:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> {</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">view</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">opts</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">}}} </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">conn</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  opts </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> maybe_dispatch_session(conn, opts)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ...snip... there&#39;s a lot of code here we&#39;re going to skip</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  conn</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.put_layout(</span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">false</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> put_root_layout_from_router(opts)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># this actually is piped into `Controller.live_render(view, opts)`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># but I&#39;m going to cut/paste what that ends up doing</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Static</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.render(conn, view, opts)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ... more snipping...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> to_rendered_content_tag(socket, tag, view, attrs)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ... more snipping...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> view.render()  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">#&lt;-- here here here!</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<p>Cool; this isn’t anything new so far. This is just confirming that Phoenix\nLiveView starts off as a regular HTTP request with a full HTML response. <em>How\ndoes it render?</em></p>\n<p>We see that it’s calling <code>view.render()</code> where <code>view</code> is our own LiveView, but\nwe didn’t define <code>render/1</code> yet! Where’s it coming from?</p>\n<p>When we called <code>use MyAppWeb, :live_view</code> it kicked off a series of <code>__using__</code>,\nwhich includes <code>use Phoenix.LiveView</code>. Inside <code>Phoenix.LiveView</code> it included a\n<code>@before_compile Phoenix.LiveView.Renderer</code> hook. Let’s check that out.</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">render? </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Module</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.defines?(env.module, {</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:render</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">1</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">})</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">root </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Path</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.dirname(env.file)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">filename </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> template_filename(env)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">templates </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Template</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.find_all(root, filename)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">case</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> {render?, templates} </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  {</span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">false</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, [template]} </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">-&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    ext </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> template </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Path</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.extname() </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">String</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.trim_leading(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;.&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">|&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">String</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.to_atom()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    engine </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Map</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.fetch!(</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Template</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.engines(), ext)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    ast </span><span class=\"grvsc-t5WxC3-6 grvsc-t88nfI-7\">=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> engine.compile(template, filename)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@file</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">unquote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(template)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@external_resource</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">unquote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(template)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">render</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(var!(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">assigns</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">)) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">        </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">unquote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(ast)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># ... other clauses</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<p>Finally! This is where the default <code>render/1</code> function comes from. Before our\nLiveView compiles, it checks to see if a <code>render/1</code> is defined, and if not, it\nwill drop one in for us. The default location for LiveView templates is right\nnext to the LiveView file itself. We see this from the <code>root = Path.dirname(env.file)</code>.</p>\n<p><a name=\"liveview-inline\"></a></p>\n<h2>Phoenix LiveView with inline <code>render/1</code></h2>\n<p>Another option is to implement <code>render/1</code> ourselves. <a href=\"https://hexdocs.pm/phoenix_live_view/Phoenix.LiveView.html#module-life-cycle\">The docs make this pretty\nclear how to do that</a>.</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/live/my_live.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyLive</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:live_view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@impl</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">mount</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_params</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_session</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">socket</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># do stuff</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    {</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:ok</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, socket}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@impl</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">render</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">assigns</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">~L&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    &lt;</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;Yo! I&#39;m rendered from a </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">&lt;%=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> my_helper(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">%&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> view&lt;/</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-7\">p</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">my_helper</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">do:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;whoops no this is actually live&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<p>This feels the most similar to frontend frameworks such as Vue with\nsingle-file-components (SFCs), or React.</p>\n<p>This is a great option in case your LiveView doesn’t have a lot of HTML. Perhaps\nyou’re implementing a small widget. At some point, however, it becomes a little\ncrowded if you have a lot of business logic handling changes in the LiveView as\nwell as hundreds of lines of HTML and functions to conditionally render some\nHTML or apply CSS classes; so you might consider separating the HTML out into\nits own file.</p>\n<p><a name=\"liveview-external\"></a></p>\n<h2>Phoenix LiveView with external <code>render/1</code></h2>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/live/my_live.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyLive</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:live_view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@impl</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">mount</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_params</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">_session</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">socket</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># do stuff</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    {</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:ok</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, socket}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">@impl</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">render</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-6 grvsc-t5WxC3-i grvsc-t88nfI-1\">assigns</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.render(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;my_live.html&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, assigns)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/views/my_view.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:view</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">my_helper</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">do:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;whoops no this is actually live&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"eex\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;!-- lib/my_app_web/templates/my/my_live.html.leex --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;p&gt;Yo! I&#39;m rendered from a </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">&lt;%=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> my_helper(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">%&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> view&lt;/p&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;!-- this renders &quot;whoops no this is actually live&quot; instead of &quot;vanilla&quot; --&gt;</span></span></span></code></pre>\n<p>If I have a lot of HTML helpers, then I tend to prefer separating that into a\nView module. It’s a little tedious to setup and separate the files, and then\njump between them when developing, but it’s clear where functions should go.</p>\n<p>This bugged me though, I have HTML floating in <code>./templates</code> and sometimes in\n<code>./live</code> and sometimes inline. Can we consolidate?</p>\n<p>Sure we can! <code>Phoenix.View</code> <a href=\"https://hexdocs.pm/phoenix/Phoenix.View.html?#__using__/1\">provides an option to look for templates in a\ndifferent folder</a>.\nLet’s try it out. We need to supply <code>root</code> and <code>path</code> with <code>use Phoenix.View</code>:</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/views/my_view.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">View</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">root:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;lib/my_app_web/live&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">path:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">namespace:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># and all the other imports that come with `use MyAppWeb, :view`</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">my_helper</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">do:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;whoops no this is actually live&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"eex\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;!-- lib/my_app_web/live/my_live.html.leex --&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;p&gt;Yo! I&#39;m rendered from a </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">&lt;%=</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> my_helper(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">) </span><span class=\"grvsc-t5WxC3-15 grvsc-t88nfI-1\">%&gt;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> view&lt;/p&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">&lt;!-- this renders &quot;whoops no this is actually live&quot; instead of &quot;vanilla&quot; --&gt;</span></span></span></code></pre>\n<p>It’s exactly the same, except where the HTML is on disk and that we can’t use\nour <code>use MyAppWeb, :view</code> as-is anymore without some further adjustment. To\nprove the concept though, copy out all the additional imports you find for views\nin <code>my_app_web.ex</code> and place it here for now. If it works out, then you can add\nanother clause in <code>my_app_web.ex</code> to handle these kinds of views. Maybe\nsomething like this.</p>\n<pre class=\"grvsc-container atom-one-light grvsc-mm-t88nfI\" data-language=\"elixir\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">view_for_live</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">quote</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">View</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">root:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;lib/my_app_web/live&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">path:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">      </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">namespace:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># Import convenience functions from controllers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Controller</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">only:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> [</span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">get_flash:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">1</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">get_flash:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">2</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">view_module:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-4\">1</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># Use all HTML functionality (forms, tags, etc)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">HTML</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">ErrorHelpers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Gettext</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Phoenix</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Helpers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">import</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">LiveHelpers</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">    </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">alias</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Router</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">.</span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Helpers</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">as:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">Routes</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\"># and then use this instead for your LiveView-centric Views</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-7 grvsc-t5WxC3-i grvsc-t88nfI-3\">### lib/my_app_web/views/my_view.ex</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">defmodule</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-4 grvsc-t88nfI-1\">MyAppWeb.MyView</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">do</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-7\">use</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-5 grvsc-t88nfI-1\">MyAppWeb</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">, </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">:view_for_live</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">  </span><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">def</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-9 grvsc-t88nfI-5\">my_helper</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">(</span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;vanilla&quot;</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\">), </span><span class=\"grvsc-t5WxC3-8 grvsc-t88nfI-4\">do:</span><span class=\"grvsc-t5WxC3-1 grvsc-t88nfI-1\"> </span><span class=\"grvsc-t5WxC3-10 grvsc-t88nfI-6\">&quot;whoops no this is actually live&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"grvsc-t5WxC3-14 grvsc-t88nfI-7\">end</span></span></span></code></pre>\n<h2>What about LiveComponents?</h2>\n<p>LiveComponents are totally ignored in this article. They’re another great option\nfor organizing interactive partials from your LiveViews. Their rendering\nstrategy is very similar to LiveViews though, and most of this applies to them\nas well.</p>\n<p>Hope these tips help you out! If you have any more tips, tweet at me\n<a href=\"https://twitter.com/bernheisel\">@bernheisel</a></p>\n<p>Thank you <a href=\"https://zachporter.dev/\">zporter</a> for helping me with the post by\nproof-reading!</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .atom-one-light {\n    background-color: #FAFAFA;\n    color: #383A42;\n  }\n  .atom-one-light .grvsc-t5WxC3-i { font-style: italic; }\n  .atom-one-light .grvsc-t5WxC3-7 { color: #A0A1A7; }\n  .atom-one-light .grvsc-t5WxC3-14 { color: #A626A4; }\n  .atom-one-light .grvsc-t5WxC3-1 { color: #383A42; }\n  .atom-one-light .grvsc-t5WxC3-4 { color: #C18401; }\n  .atom-one-light .grvsc-t5WxC3-9 { color: #4078F2; }\n  .atom-one-light .grvsc-t5WxC3-5 { color: #E45649; }\n  .atom-one-light .grvsc-t5WxC3-8 { color: #0184BC; }\n  .atom-one-light .grvsc-t5WxC3-10 { color: #50A14F; }\n  .atom-one-light .grvsc-t5WxC3-6 { color: #986801; }\n  .atom-one-light .grvsc-t5WxC3-15 { color: #CA1243; }\n  .atom-one-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n  \n  /* Monokai Phoenix */\n  @media (prefers-color-scheme: dark) {\n    .grvsc-mm-t88nfI {\n      background-color: #1e1e1e;\n      color: #F8F8F2;\n    }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-3 { color: #75715E; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-7 { color: #F92672; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-1 { color: #F8F8F2; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-4 { color: #AE81FF; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-6 { color: #E6DB74; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-5 { color: #A6E22E; }\n    .grvsc-mm-t88nfI .grvsc-t88nfI-12 { color: #64D9EA; }\n    .grvsc-mm-t88nfI .grvsc-line-highlighted::before {\n      background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n      box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n    }\n  }\n</style>","frontmatter":{"title":"Phoenix LiveView and Views","date":"June 29, 2020","tags":["elixir","phoenix"],"originalUrl":null}}},"pageContext":{"slug":"/blog/phoenix-liveview-and-views/","previous":{"fields":{"slug":"/blog/starting-a-new-podcast/"},"frontmatter":{"title":"Starting a New Podcast with Thinking |> Elixir","tags":["elixir","podcast"],"originalUrl":null,"excerpt":"I joined the Thinking |> Elixir Podcast! I would really love it if you shared\nit with shared with your friends who know or are discovering Elixir.\n"}},"next":null}}}