<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.d9a37cf4f2adb14da23c.css">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}main{display:block}h1{font-size:2em;margin:.67em 0}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}*,:after,:before{-webkit-box-sizing:border-box;box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#a0aec0}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::-ms-input-placeholder,textarea::-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@font-face{font-family:Fira Code;src:url(/FiraCode-Light.woff2) format("woff2"),url(/FiraCode-Light.woff) format("woff");font-weight:300;font-style:normal}@font-face{font-family:Fira Code;src:url(/FiraCode-Regular.woff2) format("woff2"),url(/FiraCode-Regular.woff) format("woff");font-weight:400;font-style:normal}@font-face{font-family:Fira Code;src:url(/FiraCode-Medium.woff2) format("woff2"),url(/FiraCode-Medium.woff) format("woff");font-weight:500;font-style:normal}@font-face{font-family:Fira Code;src:url(/FiraCode-SemiBold.woff2) format("woff2"),url(/FiraCode-SemiBold.woff) format("woff");font-weight:600;font-style:normal}@font-face{font-family:Fira Code;src:url(/FiraCode-Bold.woff2) format("woff2"),url(/FiraCode-Bold.woff) format("woff");font-weight:700;font-style:normal}@font-face{font-family:Fira Code VF;src:url(/FiraCode-VF.woff2) format("woff2-variations"),url(/FiraCode-VF.woff) format("woff-variations");font-weight:300 700;font-style:normal}body{background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity));--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity));font-size:1.125rem;font-weight:300;margin:0;line-height:1.5;letter-spacing:.025em;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,Arial,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.navbar,body{--bg-opacity:1}.navbar{background-color:#e2e8f0;background-color:rgba(226,232,240,var(--bg-opacity))}code,pre{letter-spacing:0;font-weight:400;font-family:Fira Code!important;border:none!important}.avatar{border-width:2px;border-radius:9999px;-webkit-box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);--border-opacity:1;border-color:#f7fafc;border-color:rgba(247,250,252,var(--border-opacity))}.button{color:#fff;color:rgba(255,255,255,var(--text-opacity));font-weight:500;padding:.5rem .75rem;border-radius:.25rem;background-color:#a0aec0;background-color:rgba(160,174,192,var(--bg-opacity));-webkit-transition-duration:.1s;transition-duration:.1s;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);text-decoration:none;-webkit-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06);box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06);border-color:#718096;border-color:rgba(113,128,150,var(--border-opacity))}.button,.button.disabled{--text-opacity:1;--bg-opacity:1;--border-opacity:1}.button.disabled{color:#000;color:rgba(0,0,0,var(--text-opacity));cursor:default;background-color:#718096;background-color:rgba(113,128,150,var(--bg-opacity));border-color:#4a5568;border-color:rgba(74,85,104,var(--border-opacity))}.button:hover{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity));--bg-opacity:1;background-color:#718096;background-color:rgba(113,128,150,var(--bg-opacity));--border-opacity:1;border-color:#4a5568;border-color:rgba(74,85,104,var(--border-opacity))}.button:focus{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity));--bg-opacity:1;background-color:#718096;background-color:rgba(113,128,150,var(--bg-opacity));--border-opacity:1;border-color:#4a5568;border-color:rgba(74,85,104,var(--border-opacity))}.post-container{--border-opacity:1;border-color:#4a5568;border-bottom:2px;border-color:rgba(74,85,104,var(--border-opacity));border-style:dotted}.link{--text-opacity:1;color:#9b2c2c;color:rgba(155,44,44,var(--text-opacity));font-weight:500;-webkit-transition-duration:.1s;transition-duration:.1s;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);text-decoration:none;-webkit-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke}.link:visited{--text-opacity:1;color:#553c9a;color:rgba(85,60,154,var(--text-opacity))}.link:hover{--text-opacity:1;color:#9b2c2c;color:rgba(155,44,44,var(--text-opacity));border-bottom-width:1px;--border-opacity:1;border-color:#38b2ac;border-color:rgba(56,178,172,var(--border-opacity))}h1.post-content:before,h1.post-header:before,h2.post-content:before,h2.post-header:before,h3.post-content:before,h3.post-header:before,h4.post-content:before,h4.post-header:before,h5.post-content:before,h5.post-header:before,h6.post-content:before,h6.post-header:before{--text-opacity:1;color:#cbd5e0;color:rgba(203,213,224,var(--text-opacity))}h1.post-content:before,h1.post-header:before{margin-right:1rem;content:"#"}h2.post-content:before,h2.post-header:before{margin-right:.75rem;content:"##"}h3.post-content:before,h3.post-header:before{margin-right:.5rem;content:"###"}h4.post-content:before,h4.post-header:before,h5.post-content:before,h5.post-header:before,h6.post-content:before,h6.post-header:before{margin-right:.25rem;content:"####"}.blog-post h1{font-weight:600;font-size:2.25rem}.blog-post h2{font-weight:600;font-size:1.875rem}.blog-post h3{font-weight:600;font-size:1.5rem}.blog-post h4,.blog-post h5{font-weight:600;font-size:1.25rem}.blog-post h6{font-weight:600;font-size:1.125rem}.post-content blockquote{padding-left:1.5rem;border-left-width:4px;--border-opacity:1;border-color:#9f7aea;border-color:rgba(159,122,234,var(--border-opacity))}.post-content p{margin-top:1rem;margin-bottom:1rem}.post-content ul{list-style-type:disc;padding-left:1rem}.post-content ol{list-style-type:decimal;padding-left:1rem}.post-content li{margin-top:.5rem;margin-bottom:.5rem}.post-content strong{font-weight:600}.post-content a{--text-opacity:1;color:#9b2c2c;color:rgba(155,44,44,var(--text-opacity));text-decoration:none;-webkit-transition-property:background-color,border-color,color,fill,stroke;transition-property:background-color,border-color,color,fill,stroke;-webkit-transition-duration:.1s;transition-duration:.1s;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}.post-content a:focus{--text-opacity:1;color:#9b2c2c;color:rgba(155,44,44,var(--text-opacity))}.post-content a:visited{--text-opacity:1;color:#553c9a;color:rgba(85,60,154,var(--text-opacity))}.post-content a:hover{--text-opacity:1;color:#9b2c2c;color:rgba(155,44,44,var(--text-opacity));border-bottom-width:1px;--border-opacity:1;border-color:#38b2ac;border-color:rgba(56,178,172,var(--border-opacity));text-decoration:none}.post-content a.gatsby-resp-image-link:hover{border-width:0}@media (prefers-color-scheme:dark){body{background-color:#1a202c;background-color:rgba(26,32,44,var(--bg-opacity));--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.navbar,body{--bg-opacity:1}.navbar{background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity));--bg-opacity:0.25}.avatar{--border-opacity:1;border-color:#2d3748;border-color:rgba(45,55,72,var(--border-opacity))}.button{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity));background-color:#718096;background-color:rgba(113,128,150,var(--bg-opacity));border-color:#a0aec0;border-color:rgba(160,174,192,var(--border-opacity))}.button,.button.disabled{--bg-opacity:1;--border-opacity:1}.button.disabled{background-color:#a0aec0;background-color:rgba(160,174,192,var(--bg-opacity));border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.button:hover{--bg-opacity:1;background-color:#a0aec0;background-color:rgba(160,174,192,var(--bg-opacity));--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.button:focus{--bg-opacity:1;background-color:#a0aec0;background-color:rgba(160,174,192,var(--bg-opacity));--border-opacity:1;border-color:#cbd5e0;border-color:rgba(203,213,224,var(--border-opacity))}.post-content a{--text-opacity:1;color:#fed7d7;color:rgba(254,215,215,var(--text-opacity))}.post-content a:focus{--text-opacity:1;color:#fed7d7;color:rgba(254,215,215,var(--text-opacity))}.post-content a:visited{--text-opacity:1;color:#e9d8fd;color:rgba(233,216,253,var(--text-opacity))}.post-content a:hover{--text-opacity:1;color:#fed7d7;color:rgba(254,215,215,var(--text-opacity))}.link{--text-opacity:1;color:#fed7d7;color:rgba(254,215,215,var(--text-opacity))}.link:visited{--text-opacity:1;color:#e9d8fd;color:rgba(233,216,253,var(--text-opacity))}.link:hover{--text-opacity:1;color:#fed7d7;color:rgba(254,215,215,var(--text-opacity));--border-opacity:1;border-color:#38b2ac;border-color:rgba(56,178,172,var(--border-opacity))}}.space-x-1>:not(template)~:not(template){--space-x-reverse:0;margin-right:calc(0.25rem*var(--space-x-reverse));margin-left:calc(0.25rem*(1 - var(--space-x-reverse)))}.space-y-4>:not(template)~:not(template){--space-y-reverse:0;margin-top:calc(1rem*(1 - var(--space-y-reverse)));margin-bottom:calc(1rem*var(--space-y-reverse))}.space-x-4>:not(template)~:not(template){--space-x-reverse:0;margin-right:calc(1rem*var(--space-x-reverse));margin-left:calc(1rem*(1 - var(--space-x-reverse)))}.block{display:block}.flex{display:-webkit-box;display:-ms-flexbox;display:flex}.inline-flex{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.hidden{display:none}.flex-col{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.flex-wrap{-ms-flex-wrap:wrap;flex-wrap:wrap}.items-center{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.justify-between{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.flex-1{-webkit-box-flex:1;-ms-flex:1 1 0%;flex:1 1 0%}.flex-shrink-0{-ms-flex-negative:0;flex-shrink:0}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-3{height:.75rem}.h-6{height:1.5rem}.h-8{height:2rem}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.leading-6{line-height:1.5rem}.leading-normal{line-height:1.5}.list-disc{list-style-type:disc}.m-auto{margin:auto}.my-2{margin-top:.5rem;margin-bottom:.5rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mt-0{margin-top:0}.ml-0{margin-left:0}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.ml-2{margin-left:.5rem}.mt-4{margin-top:1rem}.mr-4{margin-right:1rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.max-w-3xl{max-width:48rem}.p-2{padding:.5rem}.p-4{padding:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.px-3{padding-left:.75rem;padding-right:.75rem}.pl-4{padding-left:1rem}.pb-10{padding-bottom:2.5rem}.shadow-md{-webkit-box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.fill-current{fill:currentColor}.no-underline{text-decoration:none}.tracking-wider{letter-spacing:.05em}.align-middle{vertical-align:middle}.w-3{width:.75rem}.w-6{width:1.5rem}.w-16{width:4rem}.w-full{width:100%}@media (min-width:768px){.md\:font-extrabold{font-weight:800}.md\:text-4xl{font-size:2.25rem}.md\:ml-4{margin-left:1rem}.md\:w-24{width:6rem}}@media (min-width:1024px){.lg\:inline-block{display:inline-block}.lg\:flex{display:-webkit-box;display:-ms-flexbox;display:flex}.lg\:hidden{display:none}.lg\:items-center{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.lg\:mt-0{margin-top:0}.lg\:w-32{width:8rem}.lg\:w-auto{width:auto}.lg\:w-1\/2{width:50%}}code[class*=language-],pre[class*=language-]{color:#393a34;font-family:Consolas,Bitstream Vera Sans Mono,Courier New,Courier,monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre>code[class*=language-]{font-size:1em}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border:1px solid #ddd;background-color:#fff}:not(pre)>code[class*=language-]{padding:1px .2em;background:#f8f8f8;border:1px solid #ddd}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#998;font-style:italic}.token.namespace{opacity:.7}.token.attr-value,.token.string{color:#e3116c}.token.operator,.token.punctuation{color:#393a34}.token.boolean,.token.constant,.token.entity,.token.inserted,.token.number,.token.property,.token.regex,.token.symbol,.token.url,.token.variable{color:#36acaa}.language-autohotkey .token.selector,.token.atrule,.token.attr-name,.token.keyword{color:#00a4db}.language-autohotkey .token.tag,.token.deleted,.token.function{color:#9a050f}.language-autohotkey .token.keyword,.token.selector,.token.tag{color:#00009f}.token.bold,.token.function,.token.important{font-weight:700}.token.italic{font-style:italic}</style><meta name="generator" content="Gatsby 2.20.9"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  
  if(!(parseInt(navigator.doNotTrack) === 1 || parseInt(window.doNotTrack) === 1 || parseInt(navigator.msDoNotTrack) === 1 || navigator.doNotTrack === "yes")) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-9152758-1', 'auto', {});
      
      
      
      
      
      }</script><link rel="alternate" type="application/rss+xml" title="David Bernheisel&#x27;s Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/android-chrome-36x36.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="36x36" href="/android-chrome-36x36.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="apple-touch-icon" sizes="48x48" href="/android-chrome-48x48.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="apple-touch-icon" sizes="72x72" href="/android-chrome-72x72.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="apple-touch-icon" sizes="96x96" href="/android-chrome-96x96.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="apple-touch-icon" sizes="144x144" href="/android-chrome-144x144.png?v=611230f76b9c00b58e5b99e8a179a99d"/><link rel="apple-touch-icon" sizes="192x192" href="/android-chrome-192x192.png?v=611230f76b9c00b58e5b99e8a179a99d"/><title data-react-helmet="true">VIM Testing and Workflow | David Bernheisel</title><meta data-react-helmet="true" name="description" content="I realized that I love my VIM workflow, so I want to share that with you.
I am by-no-means a VIM expert or purist — my neovim files are not…"/><link as="script" rel="preload" href="/styles-48fa8a050a65bb8447bd.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-f37877f27548564a00ab.js"/><link as="script" rel="preload" href="/1777bc0a756dace6068a54d243c7071eee1627a0-3c6f7953f6c1de7fb5da.js"/><link as="script" rel="preload" href="/framework-1cbcc4f69858806ac5db.js"/><link as="script" rel="preload" href="/app-e49f8733b8aee9471acf.js"/><link as="script" rel="preload" href="/webpack-runtime-13d9dde7cfdc398a5210.js"/><link as="fetch" rel="preload" href="/page-data/blog/vim-workflow/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div><nav class="navbar flex flex-wrap items-center justify-between p-4 shadow-md"><a class="no-underline" href="/"><div class="flex items-center space-x-1"><div class="flex-shrink-0"><img src="/static/profile-picture-977b63cbce04bae4479e3185b22bfb1a.jpg" alt="David Bernheisel" class="avatar w-16 md:w-24 lg:w-32"/></div><div><h3 class="ml-0 md:ml-4 text-xl md:text-4xl md:font-extrabold leading-6 font-bold">David Bernheisel</h3></div></div></a><div class="block lg:hidden"><button class="button flex items-center px-3"><svg class="w-3 h-3 fill-current" viewBox="0 0 20 20"><title>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"></path></svg></button></div><div class="w-full block lg:mt-0 mt-4 lg:flex lg:items-center lg:w-auto hidden"><a class="no-underline block lg:inline-block mt-4 mr-4 lg:mt-0 button" href="/">Blog</a><a class="no-underline block lg:inline-block mt-4 mr-4 lg:mt-0 button" href="/projects/">Projects</a><a class="block mt-4 mr-4 button lg:inline-block lg:mt-0" href="https://twitter.com/bernheisel">Twitter</a><div class="py-1 mt-4 lg:mt-0"><a href="/rss.xml"><img class="align-middle h-8" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgICAgaWQ9IlJTU2ljb24iCiAgICAgdmlld0JveD0iMCAwIDggOCIgd2lkdGg9IjI1NiIgaGVpZ2h0PSIyNTYiPgoKICA8dGl0bGU+UlNTIGZlZWQgaWNvbjwvdGl0bGU+CgogIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAuYnV0dG9uIHtzdHJva2U6IG5vbmU7IGZpbGw6IG9yYW5nZTt9CiAgICAuc3ltYm9sIHtzdHJva2U6IG5vbmU7IGZpbGw6IHdoaXRlO30KICA8L3N0eWxlPgoKICA8cmVjdCAgIGNsYXNzPSJidXR0b24iIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHJ4PSIxLjUiIC8+CiAgPGNpcmNsZSBjbGFzcz0ic3ltYm9sIiBjeD0iMiIgY3k9IjYiIHI9IjEiIC8+CiAgPHBhdGggICBjbGFzcz0ic3ltYm9sIiBkPSJtIDEsNCBhIDMsMyAwIDAgMSAzLDMgaCAxIGEgNCw0IDAgMCAwIC00LC00IHoiIC8+CiAgPHBhdGggICBjbGFzcz0ic3ltYm9sIiBkPSJtIDEsMiBhIDUsNSAwIDAgMSA1LDUgaCAxIGEgNiw2IDAgMCAwIC02LC02IHoiIC8+Cgo8L3N2Zz4=" alt="RSS"/></a></div></div></nav><main class="max-w-3xl p-4 m-auto text-lg"><article class="blog-post"><h1 class="post-content text-3xl">VIM Testing and Workflow</h1><p class="mt-2 mb-4 text-sm frontmatter"><span>Published on <!-- -->August 28, 2019</span><span><span class="mx-2">|</span>6<!-- -->m read</span></p><div class="post-content"><p>I realized that I love my VIM workflow, so I want to share that with you.
I am by-no-means a VIM expert or purist — my <a href="https://neovim.io">neovim</a> files are not slim and
are a melting pot of stolen code from others, sometimes modified or not,
sometimes found in GitHub comments, sometimes found in others’ dotfiles, or
Reddit comments.</p>
<p>If you develop in Ruby or Elixir or write Markdown, you might find this helpful!</p>
<p>Let’s start with some basics:</p>
<h2>Environment</h2>
<ul>
<li><a href="https://neovim.io">neovim</a> - right now I’m using 0.4.0 so I can use floating windows.</li>
<li><a href="https://sw.kovidgoyal.net/kitty/">kitty</a> Terminal Emulator</li>
<li>built-in terminal in neovim</li>
<li><a href="https://www.archlinux.org">ArchLinux</a> - My distro of choice. Shouldn’t matter for this article.</li>
<li><a href="https://github.com/Airblader/i3">i3</a> - My window manager. Shouldn’t matter for this article.</li>
<li><a href="https://github.com/junegunn/vim-plug">Plug</a> - for managing neovim plugins.</li>
<li><a href="https://github.com/neoclide/coc.nvim">nvim-coc</a> for languageserver integration.</li>
<li><a href="https://github.com/dbernheisel/dotfiles">dotfiles</a> - My dotfiles if you want the complete picture</li>
</ul>
<p>There are three ways that I can split my workspace: (1) via my window manager
<a href="https://github.com/Airblader/i3">i3</a>, (2) via my terminal emulator <a href="https://sw.kovidgoyal.net/kitty/">kitty</a>, (3) via <a href="https://neovim.io">neovim</a> with
splits/buffers. Generally I adhere to this practice:</p>
<ol>
<li>Split with i3 if it’s an application, especially a GUI app. This gives me
the ability to move the window to another desktop if I want.</li>
<li>Split with built-in neovim terminal for tests.</li>
<li>Don’t split with kitty ever. It’d be too confusing for me to have 3 sets of
keyboard shortcuts to keep track of for switching windows/panes/splits.
Maybe one day I’ll replace the built-in neovim terminal with a kitty split
or an i3 split.</li>
</ol>
<h2>Testing</h2>
<p>I use <a href="https://github.com/janko/vim-test">vim-test</a> and it’s pretty incredible. I picked this workflow up while
working at thoughtbot from some good friends and the <a href="https://github.com/thoughtbot/dotfiles">thoughtbot dotfiles</a>,
and it changed the way I code. The whole TDD workflow is great despite that I
still have trouble actually writing tests first - I tend to spike, iterate,
iterate, THEN write tests, then open a PR. Yea— this probably means I’m not a
10x developer 😛</p>
<p>I also use neoterm to help open up terminal splits. When I’m at home, I have an
ultrawide that I use so splitting windows vertically is the way to go; but when
I’m mobile with my laptop then I typically split horizontally. I want tests to
be visible either way, so I need this to be flexible.</p>
<p>The vim-test neoterm strategy defaults to sending tests to the last-used neoterm
buffer; I can have more terminal buffers, but the first one I open is what
vim-test will use going forward.</p>
<p>Here’s how I configure vim-test with neoterm. (my <a href="https://github.com/dbernheisel/dotfiles">dotfiles</a> for reference)</p>
<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token comment">" ~/.config/nvim/init.vim</span>

<span class="token comment">" Test</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>test#strategy <span class="token operator">=</span> <span class="token string">"neoterm"</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_shell <span class="token operator">=</span> <span class="token string">'$SHELL -l'</span> <span class="token comment">" use the login shell</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_default_mod <span class="token operator">=</span> <span class="token string">'vert'</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_autoscroll <span class="token operator">=</span> <span class="token number">1</span>      <span class="token comment">" autoscroll to the bottom when entering insert mode</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_size <span class="token operator">=</span> <span class="token number">80</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_fixedsize <span class="token operator">=</span> <span class="token number">1</span>       <span class="token comment">" fixed size. The autosizing was wonky for me</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_keep_term_open <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">" when buffer closes, exit the terminal too.</span>
<span class="token keyword">let</span> test#<span class="token keyword">ruby</span>#rspec#<span class="token keyword">options</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">'suite'</span><span class="token punctuation">:</span> <span class="token string">'--profile 5'</span> <span class="token punctuation">}</span>

<span class="token comment">" Create some commands that makes the splits easy</span>

<span class="token keyword">function</span><span class="token operator">!</span> <span class="token function">OpenTermV</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_size <span class="token operator">=</span> <span class="token number">80</span>
  <span class="token keyword">let</span> <span class="token keyword">l</span><span class="token punctuation">:</span>cmd <span class="token operator">=</span> a<span class="token punctuation">:</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">?</span> <span class="token string">'pwd'</span> <span class="token punctuation">:</span> a<span class="token punctuation">:</span><span class="token number">1</span>
  execute <span class="token string">'vert T '</span><span class="token operator">.</span><span class="token keyword">l</span><span class="token punctuation">:</span>cmd
<span class="token keyword">endfunction</span>

<span class="token keyword">function</span><span class="token operator">!</span> <span class="token function">OpenTermH</span><span class="token punctuation">(</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">.</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> g<span class="token punctuation">:</span>neoterm_size <span class="token operator">=</span> <span class="token number">10</span>
  <span class="token keyword">let</span> <span class="token keyword">l</span><span class="token punctuation">:</span>cmd <span class="token operator">=</span> a<span class="token punctuation">:</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token operator">?</span> <span class="token string">'pwd'</span> <span class="token punctuation">:</span> a<span class="token punctuation">:</span><span class="token number">1</span>
  execute <span class="token string">'belowright T '</span><span class="token operator">.</span><span class="token keyword">l</span><span class="token punctuation">:</span>cmd
<span class="token keyword">endfunction</span>

command<span class="token operator">!</span> <span class="token operator">-</span>nargs<span class="token operator">=</span><span class="token operator">?</span> VT <span class="token keyword">call</span> <span class="token function">OpenTermV</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">q</span><span class="token operator">-</span><span class="token keyword">args</span><span class="token operator">></span><span class="token punctuation">)</span>
command<span class="token operator">!</span> <span class="token operator">-</span>nargs<span class="token operator">=</span><span class="token operator">?</span> HT <span class="token keyword">call</span> <span class="token function">OpenTermH</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token keyword">q</span><span class="token operator">-</span><span class="token keyword">args</span><span class="token operator">></span><span class="token punctuation">)</span>

<span class="token comment">" Use the project's test suite script if it exists</span>

<span class="token keyword">function</span><span class="token operator">!</span> <span class="token function">RunTestSuite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  Tclear
  <span class="token keyword">if</span> <span class="token function">filereadable</span><span class="token punctuation">(</span><span class="token string">'bin/test_suite'</span><span class="token punctuation">)</span>
    T echo <span class="token string">'bin/test_suite'</span>
    T <span class="token builtin">bin</span><span class="token operator">/</span>test_suite
  <span class="token keyword">elseif</span> <span class="token function">filereadable</span><span class="token punctuation">(</span><span class="token string">"bin/test"</span><span class="token punctuation">)</span>
    T echo <span class="token string">'bin/test'</span>
    T <span class="token builtin">bin</span><span class="token operator">/</span>test
  <span class="token keyword">else</span>
    TestSuite
  <span class="token keyword">endif</span>
<span class="token keyword">endfunction</span>

nmap <span class="token operator">&lt;</span><span class="token keyword">silent</span><span class="token operator">></span> <span class="token operator">&lt;</span>leader<span class="token operator">></span><span class="token keyword">t</span> <span class="token punctuation">:</span><span class="token keyword">call</span> TestNearest<span class="token operator">&lt;</span>CR<span class="token operator">></span>
nmap <span class="token operator">&lt;</span><span class="token keyword">silent</span><span class="token operator">></span> <span class="token operator">&lt;</span>leader<span class="token operator">></span>T <span class="token punctuation">:</span><span class="token keyword">call</span> TestFile<span class="token operator">&lt;</span>CR<span class="token operator">></span>
nmap <span class="token operator">&lt;</span><span class="token keyword">silent</span><span class="token operator">></span> <span class="token operator">&lt;</span>leader<span class="token operator">></span>a <span class="token punctuation">:</span><span class="token keyword">call</span> <span class="token function">RunTestSuite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>CR<span class="token operator">></span>
nmap <span class="token operator">&lt;</span><span class="token keyword">silent</span><span class="token operator">></span> <span class="token operator">&lt;</span>leader<span class="token operator">></span><span class="token keyword">l</span> <span class="token punctuation">:</span><span class="token keyword">call</span> TestLast<span class="token operator">&lt;</span>CR<span class="token operator">></span></code></pre></div>
<p>I’ve found it conventional to have a <code class="language-text">bin/test_suite</code> or <code class="language-text">bin/test</code> script in
the project that takes care of a lot of details like environment exports,
cleanup, or making sure the test environment’s database is setup as well as
running all the tests. Even if the test suite isn’t complicated, it’s still
helpful for new developers on the project.</p>
<p>If that script is present and when I want to run all tests, I should execute
that file; otherwise use the default vim-test suite command. For non-suite
tests, I use the default vim-test commands.</p>
<p><code class="language-text">&lt;space&gt;a</code> triggers <strong>a</strong>ll tests. If a neoterm split isn’t open,
then it’ll automatically open one with the default settings— in my case, a
vertical split at 80 columns wide. If a neoterm split is already open, then
it’ll send the test to that split. In situations where my vertical space is
lacking, I prep by opening up a split, and then hit my test shortcut. <code class="language-text">:HT</code> to
open the terminal up.</p>
<p>If I’m testing a method or function, then <code class="language-text">&lt;space&gt;t</code> to send the nearest
<strong>t</strong>est to it. If I’m trying to make a test pass, I’ll modify the code and then
<code class="language-text">&lt;space&gt;l</code> to run the <strong>l</strong>ast test. If I’m refactoring a class or module, I’ll
run all the <strong>T</strong>ests for it. I haven’t found myself using vim-test’s TestVisit.
If you have some examples on where that command helps, I’d love to hear it!</p>
<p><a href="https://asciinema.org/a/gs6r5QlC8oR8HPNYhRPDypY6n"><img src="https://asciinema.org/a/gs6r5QlC8oR8HPNYhRPDypY6n.svg" alt="asciicast"></a></p>
<h2>Transformations</h2>
<p>This is a great start! But eventually there might be a pesky app where I need to
opt-into an environment variable, but only when I’m running a small number of
tests. vim-test lets me define my own transformations to the commands. I can
check for a certain file and string in it to determine what project I’m in. If
I’m in that project, then change the command where I can.</p>
<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token comment">" ~/.config/nvim/after/ftplugin/ruby.vim</span>

<span class="token keyword">function</span><span class="token operator">!</span> <span class="token function">MyAppRspec</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> abort
  <span class="token comment">" If I'm in the pesky app and</span>
  <span class="token comment">" not running the entire test suite indicated by the --profile flag</span>
  <span class="token comment">" Add the SKIP_FIXTURES env var.</span>
  <span class="token keyword">call</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat README.md | grep 'MyApp'"</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token function">match</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span>cmd<span class="token punctuation">,</span> <span class="token string">'--profile'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> v<span class="token punctuation">:</span>shell_error <span class="token operator">==</span> <span class="token number">0</span>
    <span class="token keyword">return</span> <span class="token function">substitute</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span>cmd<span class="token punctuation">,</span> <span class="token string">'bundle exec'</span><span class="token punctuation">,</span> <span class="token string">'SKIP_FIXTURES=true bundle exec'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> a<span class="token punctuation">:</span>cmd
  <span class="token keyword">endif</span>
<span class="token keyword">endfunction</span>

<span class="token keyword">let</span> g<span class="token punctuation">:</span>test#custom_transformations <span class="token operator">=</span> <span class="token punctuation">{</span>
      \ <span class="token string">'myapp_ruby'</span><span class="token punctuation">:</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token string">'MyAppRspec'</span><span class="token punctuation">)</span>
      \ <span class="token punctuation">}</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>test#transformation <span class="token operator">=</span> <span class="token string">'myapp_ruby'</span></code></pre></div>
<p>On the Elixir side, umbrella apps can be a little tricky. vim-test will send the
path of the test to <code class="language-text">mix test {file}</code>, but <code class="language-text">mix</code> will run that command for each
of the apps in the umbrella. That’s probably not what we want to do since that
test exists for only one for apps. Again, we can solve it with a transformation.</p>
<div class="gatsby-highlight" data-language="vim"><pre class="language-vim"><code class="language-vim"><span class="token comment">" ~/.config/nvim/after/ftplugin/elixir.vim</span>

<span class="token keyword">function</span><span class="token operator">!</span> <span class="token function">ElixirUmbrellaTransform</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> abort
  <span class="token comment">" if in an umbrella project indicated by the existence of an ./apps folder</span>
  <span class="token comment">" limit the mix command to the app to which the test belongs</span>
  <span class="token keyword">if</span> <span class="token function">match</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span>cmd<span class="token punctuation">,</span> <span class="token string">'apps/'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token comment">" capture the app from the file path, and send it to the --app flag instead</span>
    <span class="token keyword">return</span> <span class="token function">substitute</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span>cmd<span class="token punctuation">,</span> <span class="token string">'mix test apps/\([^/]*\)/'</span><span class="token punctuation">,</span> <span class="token string">'mix cmd --app \1 mix test --color '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> a<span class="token punctuation">:</span>cmd
  end
<span class="token keyword">endfunction</span>

<span class="token keyword">let</span> g<span class="token punctuation">:</span>test#custom_transformations <span class="token operator">=</span> <span class="token punctuation">{</span>
       \ <span class="token string">'elixir_umbrella'</span><span class="token punctuation">:</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token string">'ElixirUmbrellaTransform'</span><span class="token punctuation">)</span>
       \ <span class="token punctuation">}</span>
<span class="token keyword">let</span> g<span class="token punctuation">:</span>test#transformation <span class="token operator">=</span> <span class="token string">'elixir_umbrella'</span></code></pre></div>
<p>That’s it for tests!</p>
<p>Hope you picked up something nifty. If you have any tips for me, send them my
way <a href="https://twitter.com/bernheisel">@bernheisel</a></p></div></article><div class="flex flex-wrap justify-between"><div class="w-full p-2 lg:w-1/2"><a class="no-underline inline-flex items-center flex-1 dark:button-dark button" href="/blog/httpoison-decompression/"><svg class="w-6 h-6 mr-2 fill-current" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1408 960v-128q0-26-19-45t-45-19h-502l189-189q19-19 19-45t-19-45l-91-91q-18-18-45-18t-45 18l-362 362-91 91q-18 18-18 45t18 45l91 91 362 362q18 18 45 18t45-18l91-91q18-18 18-45t-18-45l-189-189h502q26 0 45-19t19-45zm256-64q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"></path></svg><span>HTTPoison and Decompression</span></a></div><div class="w-full p-2 lg:w-1/2"><a class="no-underline inline-flex items-center flex-1 dark:button-dark button" href="/blog/date-time-parser-podcast/"><span>DateTimeParser on Elixir Mix podcast</span><svg class="w-6 h-6 ml-2 fill-current" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1413 896q0-27-18-45l-91-91-362-362q-18-18-45-18t-45 18l-91 91q-18 18-18 45t18 45l189 189h-502q-26 0-45 19t-19 45v128q0 26 19 45t45 19h502l-189 189q-19 19-19 45t19 45l91 91q18 18 45 18t45-18l362-362 91-91q18-18 18-45zm251 0q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"></path></svg></a></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/vim-workflow/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e49f8733b8aee9471acf.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-8dc5b1de7df84c955e11.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-f37877f27548564a00ab.js"],"component---src-pages-404-js":["/component---src-pages-404-js-f9633554493dddb1c536.js"],"component---src-pages-index-js":["/component---src-pages-index-js-f71e923739c6685c4443.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-ce130e74c0d10fe8ba37.js"]};/*]]>*/</script><script src="/webpack-runtime-13d9dde7cfdc398a5210.js" async=""></script><script src="/app-e49f8733b8aee9471acf.js" async=""></script><script src="/framework-1cbcc4f69858806ac5db.js" async=""></script><script src="/1777bc0a756dace6068a54d243c7071eee1627a0-3c6f7953f6c1de7fb5da.js" async=""></script><script src="/component---src-templates-blog-post-js-f37877f27548564a00ab.js" async=""></script><script src="/styles-48fa8a050a65bb8447bd.js" async=""></script></body></html>